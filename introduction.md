# 项目文件说明 - 给初学者的指南

嗨！这个文档会用最简单的话解释这个项目里每个文件是干什么的。

## 📁 项目整体结构

这是一个网站项目，用户可以输入文字，然后网站会自动生成一张绿色背景的图片（就像 Charlie XCX 的 Brat 专辑封面那样）。

---

## 📄 根目录文件

### `README.md`
- **作用**：这是项目的"说明书"，告诉别人这个项目是做什么的
- **给谁看的**：其他程序员、或者未来的你
- **内容**：项目介绍、如何运行、当前进度等

### `prd.md`
- **作用**：Product Requirement Document（产品需求文档）
- **内容**：详细描述这个网站要实现什么功能、什么样子
- **给谁看的**：开发者（也就是我们），用来明确要做什么

### `introduction.md`（就是你正在看的这个文件）
- **作用**：用最简单的话解释每个文件的作用
- **给谁看的**：你！帮助你理解项目结构

### `package.json`
- **作用**：记录这个项目需要哪些"工具包"（依赖）
- **比喻**：就像你做蛋糕需要的材料清单
- **内容**：项目名称、需要的包、运行命令等

### `.gitignore`
- **作用**：告诉 Git 哪些文件不需要上传
- **为什么**：有些文件太大或者是自动生成的，不需要保存

---

## 📁 `app/` 文件夹

这是 Next.js 14 最重要的文件夹！网站的所有页面都在这里。

### `app/[lang]/` 文件夹（多语言支持）
- **作用**：动态路由文件夹，支持不同语言
- **比喻**：就像一个房子有不同语言的房间（/en、/zh）
- **为什么用 [lang]**：方括号表示"动态"，可以匹配 /en、/zh 等不同路径

### `app/[lang]/layout.tsx`
- **作用**：整个网站的"外壳"（支持多语言）
- **比喻**：就像房子的框架，每个房间都在这个框架里
- **内容**：网站的标题、字体、全局样式、SEO 设置
- **特别之处**：会根据语言（en/zh）生成不同的标题和描述

### `app/[lang]/page.tsx`
- **作用**：网站的首页（支持多语言）
- **比喻**：就是你打开网站看到的第一个页面
- **内容**：输入框、生成按钮、图片预览、下载按钮
- **特别之处**：所有文字都会根据语言自动切换

### `app/globals.css`
- **作用**：全局样式表
- **内容**：整个网站通用的样式设计
- **比喻**：就像给整个房子定义装修风格

---

## 📁 `components/` 文件夹

存放可重复使用的"组件"。

### `components/BratGenerator.tsx`
- **作用**：Brat 图片生成器的核心组件
- **功能**：
  - 提供一个输入框让用户输入文字
  - 点击按钮后生成图片
  - 显示生成的图片
  - 提供下载按钮
- **比喻**：就像一个完整的"图片制作工作台"

---

## 📁 `utils/` 文件夹

存放"工具函数"，就是一些可以重复使用的功能代码。

### `utils/imageGenerator.ts`
- **作用**：负责生成 Brat 风格图片的所有逻辑
- **功能**：
  - 创建一个虚拟画布（Canvas）
  - 在画布上画绿色背景（#8ACE00）
  - 在画布上写黑色文字（Arial Narrow 字体）
  - **自动换行**：文字太长会自动换行，不会溢出
  - **随机空格**：在单词之间随机插入额外空格（0-3个），让排版看起来更"疯狂"
  - **窄边距**：四周只留 20px 边距，让文字尽可能填满画布
  - 把画布转换成可以下载的图片
- **比喻**：就像 Photoshop 的自动化脚本

---

## 📁 `i18n/` 文件夹（国际化/多语言）

这个文件夹管理网站的多语言功能。

### `i18n/config.ts`
- **作用**：配置支持哪些语言
- **内容**：
  - 语言列表（en 英文、zh 中文）
  - 默认语言（en）
- **比喻**：就像餐厅的菜单语言选项

### `i18n/dictionaries/en.json`
- **作用**：英文翻译文件
- **内容**：所有英文文字（标题、按钮、提示等）
- **格式**：JSON 格式，键值对

### `i18n/dictionaries/zh.json`
- **作用**：中文翻译文件
- **内容**：所有中文文字（标题、按钮、提示等）
- **格式**：JSON 格式，键值对

### `i18n/get-dictionary.ts`
- **作用**：获取指定语言的翻译
- **功能**：根据语言代码（en/zh）返回对应的翻译文件
- **比喻**：就像翻译器，告诉它要什么语言，它就给你那个语言的文字

---

## 📄 `middleware.ts`（中间件）

- **作用**：在用户访问网站时自动检测语言
- **功能**：
  - 检测用户浏览器的语言设置
  - 自动重定向到对应语言页面
  - 例如：访问 `/` 会自动跳转到 `/en` 或 `/zh`
- **比喻**：就像餐厅的服务员，看你是哪国人，自动给你对应语言的菜单

---

## 🎨 样式和设计

- **Apple 风格**：我们用了苹果公司的设计风格 - 简洁、优雅、留白多
- **响应式**：在手机、平板、电脑上都好看
- **颜色**：主要是白色、灰色，生成的图片用 #8ACE00（亮绿色）

---

## 🔧 技术名词解释

### Next.js
- 一个用来做网站的"框架"（工具箱）
- 让做网站变得更简单

### React
- 用来做网站界面的"库"
- 可以把页面拆分成一个个小组件

### TypeScript
- JavaScript 的"升级版"
- 会自动检查代码错误，更安全

### Canvas API
- 浏览器自带的画图工具
- 我们用它来生成 Brat 风格的图片

---

## 📝 文件更新日志

每次添加或修改文件时，我都会在这里记录：

### 2026-01-04

#### 第一版
- ✅ 创建了项目基础文件：README.md, introduction.md
- ✅ 创建了完整的 Next.js 项目结构
- ✅ 实现了核心功能：文本输入 → 实时预览 → 图片下载
- ✅ 完成了所有 SEO 优化要求
- ✅ 应用了 Apple 风格设计
- ✅ 实现了响应式布局（手机、平板、电脑都适配）
- ✅ 开发服务器已启动，可以在浏览器中测试

#### 第二版（PRD 更新）
- ✅ 添加了字体特效：高斯模糊 30%（让字体看起来更有质感）
- ✅ 优化了字体大小算法：
  - 1行文字：字体高度 = 画布高度的 1/3（约 333px）
  - 2行文字：字体高度 = 画布高度的 1/4（约 250px）
  - 3行文字：字体高度 = 画布高度的 1/5（约 200px）
  - 4行+文字：字体高度 = 画布高度的 1/6.5（约 153px）
- ✅ 确认图片比例为 1:1（1000x1000 像素）

#### 第三版（基于官方网站优化）
- ✅ 通过浏览器开发者工具分析了官方 bratgenerator.com 的字体设置
- ✅ 更新模糊效果：从 3px 改为 2px（与官方一致）
- ✅ 更新字体粗细：从 bold 改为 500/medium（与官方一致）
- ✅ 移除了横向拉伸效果：直接使用 Arial Narrow 字体（与官方一致）
- ✅ 优化行高：改为与字体大小相同（line-height = font-size）
- ✅ 确认文字完美居中：水平居中 + 垂直居中

#### 第四版（自动换行 + 多语言支持）
- ✅ 实现文字自动换行功能：
  - 当文字太长时，自动换行，不会溢出画布
  - 使用智能算法计算每行宽度
  - 根据最终行数自动调整字体大小
- ✅ 完整的多语言架构：
  - 支持英文（/en）和中文（/zh）
  - 使用 Next.js 14 动态路由 `[lang]`
  - 自动检测用户浏览器语言并重定向
  - 所有文字都可以翻译（标题、按钮、提示等）
- ✅ SEO 多语言优化：
  - 每个语言有独立的标题和描述
  - 正确设置 hreflang 标签
  - 设置 canonical URL
- ✅ 代码结构：
  - 翻译文件独立管理（i18n/dictionaries/）
  - 组件支持接收翻译参数
  - 易于添加新语言

### 2026-01-05

#### 第六版（v1.2 - 完整功能版）
- ✅ **后端数据存储**：集成 Supabase 数据库
  - 用户可以上传图片到 Gallery
  - 数据永久保存在云端
  - 免费且稳定的解决方案
- ✅ **Gallery 页面**：
  - 展示所有用户上传的图片
  - 点赞功能（实时更新）
  - 按点赞数排序显示
  - 响应式网格布局
- ✅ **单张图片详情页**：
  - 每张图片都有独立的 URL（SEO 优化）
  - 完整的图片信息展示
  - 点赞和分享功能
  - 面包屑导航
- ✅ **Brat Color 页面**：
  - 展示 #8ACE00 色值
  - HEX、RGB、HSL 三种格式
  - 颜色介绍和历史
  - 精美的视觉设计
- ✅ **SEO 全面优化**：
  - 结构化数据（Schema.org JSON-LD）
  - 面包屑导航（所有页面）
  - robots.txt（动态生成）
  - sitemap.xml（包含所有页面）
  - 优化图片 alt 文本（英文）
- ✅ **API 路由**：
  - POST /api/images - 上传图片
  - GET /api/images - 获取所有图片
  - POST /api/images/[id]/like - 点赞
- ✅ **文档完善**：
  - SUPABASE_SETUP.md - 详细的设置指南
  - 环境变量配置说明

#### 第五版（疯狂排版效果）
- ✅ 大幅缩小四周边距：从 80px 减少到 20px
  - 让文字尽可能靠近边缘，营造紧凑的视觉效果
  - 更好地还原官方 Brat 风格的排版
- ✅ 随机空格效果：在单词之间随机插入 0-3 个额外空格
  - 创建不规则、"疯狂"的排版效果
  - 每次生成图片时空格位置都会变化
  - 让图片看起来更有个性和趣味性
- ✅ 新增 `addRandomSpaces()` 函数：
  - 智能处理文本，在单词间添加随机空格
  - 保持文本可读性的同时增加视觉冲击力
- ✅ 重新设计字号计算逻辑（重要优化）：
  - **优先换行**：当一行文字太长时，不缩小字号，直接换行
  - **最大化字号**：从大字号开始尝试，让文字尽可能大
  - **智能缩放**：只有当整体内容溢出画布时才缩小字号
  - **循环优化**：每次缩小 5%，找到最佳字号
  - **效果**：文字内容较多时，始终基本填满整个画布
  - 设置最小字号为 40px，防止文字过小

